1. 概述
该系统是 在飞书文档基础上通过引入AI增强的问答系统，它使用飞书SDK下载文档，再将文档的内容向量化并存入Elasticsearch（ES）。此后，当用户通过飞书机器人提问时，系统将问题同样向量化并在ES中进行搜索，得出结果后，使用预设模板组装回复，最后通过OpenAI的LLM接口加工结果为语义化的回答返回给用户 同时附带原始链接 提高目前的知识库的使用效率 增加积累的知识的价值。

2. 产品意义与价值
该问答系统结合了飞书SDK，OpenAI技术和Elasticsearch，为用户提供了一个快速、准确且具有高度智能化的信息查询服务。
1. 提高效率：系统实现了全自动化的信息查询和回答生成，避免了人工查询的时间消耗，大大提高了工作效率。
2. 提升准确性：通过AI的语义理解和嵌入技术，系统能够准确匹配用户的问题与相应的答案，减少了传统人工搜索可能出现的错误。
3. 智能互动：借助飞书机器人，系统能够与用户进行自然语言的交互，增强效率。
4. 扩展知识库：由于系统可以将任何通过飞书SDK下载的Markdown文档加入到ES中，因此具有很强的知识库扩展性。
5. 数据驱动：所有的问答数据都可以被记录和分析，在后续可以进行分析那些地方需要补充和完善. 提高知识库价值

3. 详细流程
 3.1 文档处理
- 下载文档：我们首先通过飞书SDK下载文档，并将其转化为Markdown格式，方便进一步的内容处理。
- 语义拆分：为了获得精准的内容搜索结果，我们将Markdown文档进行语义拆分，将其划分为合适的文字块。
- 内容向量化：借助OpenAI的embedding接口，我们将拆分出的文字块向量化。这使得我们可以高效地搜索和比较文档中的内容。
- 数据存储：将飞书文档的原始链接，文字块在文档中的位置，文字块的内容，以及向量化的结果，一并写入到ES中。
- 数据更新: 相同的飞书文档(以链接为准)进行同步时 会删除老的文档 然后同步更新新的文档. 避免出现文档更新后 知识库无法更新的问题
- 数据删除: 目前无法直接删除 只能后台操作 手动删除
 3.2 用户查询处理
- 问题向量化：当用户通过飞书机器人进行提问时，我们首先使用OpenAI的embedding接口，将用户的问题向量化。
- 搜索匹配：将问题的向量在ES中进行KNN搜索，以得到最相关的搜索结果。
- 结果组装：在获取搜索结果后，我们使用预设的prompt模板对结果进行组装，为生成回答做准备。
- 生成回答：最后，我们通过OpenAI的LLM接口对组装的结果进行进一步加工，生成具有良好语义和逻辑连贯性的回答。
- 返回回答：将生成的回答通过飞书机器人返回给用户，完成整个查询流程。
- 上线文关联: 因目前是通过接口调用 无法支持上下文关联 暂不支持


---
附图: 
1. 流程图
[图片]
2. 架构图
暂时无法在飞书文档外展示此内容
可扩展行
1. 通过对目前文档的加工, 以及内部同事的使用记录  完善目前目前已有知识库. 
2. 增加自动流程 在用户提交相关技术文档的时候 进行基于目前知识库的积累 进行一定的提示和补充 加快和完善技术文档的产出.
3. 基于目前文档的理解 尝试性质的构建技术概念知识图谱(wiki). 在进行项目技术方案阶段 通过现有能力 进行一定的评估和完善.
使用指南
1. 基于飞书文档的ai问答系统使用指南 
2. 基于飞书文档的ai问答系统需求进度 